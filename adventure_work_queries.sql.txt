-- 1) Total Sales by Year
SELECT 
    YEAR(OrderDate) AS SalesYear,
    SUM(SalesAmount) AS TotalSales
FROM FactInternetSales
GROUP BY YEAR(OrderDate)
ORDER BY SalesYear;


-- 2) Total Sales by Month 
SELECT 
    FORMAT(OrderDate, 'yyyy-MM') AS YearMonth,
    SUM(SalesAmount) AS TotalSales
FROM FactInternetSales
GROUP BY FORMAT(OrderDate, 'yyyy-MM')
ORDER BY YearMonth;


-- 3) Top 10 Customers by Sales
SELECT TOP 10
    c.FirstName + ' ' + c.LastName AS CustomerName,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimCustomer c ON s.CustomerKey = c.CustomerKey
GROUP BY c.FirstName, c.LastName
ORDER BY TotalSales DESC;


-- 4) Sales by Country
SELECT 
    g.EnglishCountryRegionName AS Country,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimCustomer c ON s.CustomerKey = c.CustomerKey
JOIN DimGeography g ON c.GeographyKey = g.GeographyKey
GROUP BY g.EnglishCountryRegionName
ORDER BY TotalSales DESC;


-- 5) Sales by Product Category
SELECT 
    pc.EnglishProductCategoryName AS Category,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimProduct p ON s.ProductKey = p.ProductKey
JOIN DimProductSubcategory ps ON p.ProductSubcategoryKey = ps.ProductSubcategoryKey
JOIN DimProductCategory pc ON ps.ProductCategoryKey = pc.ProductCategoryKey
GROUP BY pc.EnglishProductCategoryName
ORDER BY TotalSales DESC;


-- 6) Sales by Product Subcategory
SELECT 
    ps.EnglishProductSubcategoryName AS SubCategory,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimProduct p ON s.ProductKey = p.ProductKey
JOIN DimProductSubcategory ps ON p.ProductSubcategoryKey = ps.ProductSubcategoryKey
GROUP BY ps.EnglishProductSubcategoryName
ORDER BY TotalSales DESC;


-- 7) Top 10 Products by Revenue
SELECT TOP 10
    p.EnglishProductName AS Product,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimProduct p ON s.ProductKey = p.ProductKey
GROUP BY p.EnglishProductName
ORDER BY TotalSales DESC;


-- 8) Total Orders Count
SELECT 
    COUNT(DISTINCT SalesOrderNumber) AS TotalOrders
FROM FactInternetSales;


-- 9) Average Order Value (AOV)
SELECT 
    SUM(SalesAmount) / COUNT(DISTINCT SalesOrderNumber) AS AvgOrderValue
FROM FactInternetSales;


-- 10) Profit Calculation (Sales - Total Cost)
SELECT
    SUM(SalesAmount) AS TotalSales,
    SUM(TotalProductCost) AS TotalCost,
    SUM(SalesAmount - TotalProductCost) AS TotalProfit
FROM FactInternetSales;


-- 11) Profit by Year
SELECT 
    YEAR(OrderDate) AS SalesYear,
    SUM(SalesAmount - TotalProductCost) AS TotalProfit
FROM FactInternetSales
GROUP BY YEAR(OrderDate)
ORDER BY SalesYear;


-- 12) Customer Count by Gender
SELECT 
    Gender,
    COUNT(*) AS TotalCustomers
FROM DimCustomer
GROUP BY Gender;


-- 13) Sales by Marital Status
SELECT 
    c.MaritalStatus,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimCustomer c ON s.CustomerKey = c.CustomerKey
GROUP BY c.MaritalStatus
ORDER BY TotalSales DESC;


-- 14) Sales by Education Level
SELECT 
    c.EnglishEducation AS EducationLevel,
    SUM(s.SalesAmount) AS TotalSales
FROM FactInternetSales s
JOIN DimCustomer c ON s.CustomerKey = c.CustomerKey
GROUP BY c.EnglishEducation
ORDER BY TotalSales DESC;


-- 15) Repeat Customers (Customers with more than 1 Order)
SELECT 
    CustomerKey,
    COUNT(DISTINCT SalesOrderNumber) AS TotalOrders
FROM FactInternetSales
GROUP BY CustomerKey
HAVING COUNT(DISTINCT SalesOrderNumber) > 1
ORDER BY TotalOrders DESC;
